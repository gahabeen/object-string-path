/*!
  * object-string-path v0.1.0
  * (c) 2020 Gabin Desserprit
  * @license MIT
  */
const e=/^\^/,t=/({.*?})/gim,n="<~~~>",r="<~OBRACK~>",o="<~CBRACK~>",i="<~ARR~>";function s(e){return["number","string","symbol"].includes(typeof e)}function c(e){let t,n;function r(e){return"[object Object]"===Object.prototype.toString.call(e)}return!1!==r(e)&&(t=e.constructor,void 0===t||(n=t.prototype,!1!==r(n)))}function p(e){return"<~ARR~>"+e.join("<~ARR~>")+"<~ARR~>"}function l(e){const t=e.match(new RegExp("<~ARR~>","gim"));return t&&3===t.length}function u(e){return e.replace(/\./gim,"<~~~>").replace(/\[/gim,"<~OBRACK~>").replace(/\]/gim,"<~CBRACK~>")}function f(e){return e.replace(new RegExp("<~~~>","gim"),".").replace(new RegExp("<~OBRACK~>","gim"),"[").replace(new RegExp("<~CBRACK~>","gim"),"]")}function a(e){return String(e).replace(t,u).replace(/\[/g,".").replace(/^\./,"").replace(/]/g,"").split(".")}function g(e){return t=>{if((t=t.slice(1,-1)).length>0){const n=v(e,t,e);return Array.isArray(n)?p(n):n}return"undefined"}}function d(n,r,o){r=r||{},o=o||{};let i=n[0];const c={step:null,_steps:n.slice(1),failed:!1};if(["array","string","number"].includes(typeof i))if(i=""+i.trim(),i=f(i),i=i.replace(e,""),i=i.replace(t,g(o)),i.includes("undefined"))c.failed=!0;else if(l(i)||i.includes("=")){const e=l(i)?i.split("<~ARR~>").slice(1,-1):i.split("=").filter(Boolean).map(e=>e.trim());if(2===e.length){const[t,n]=e,o=y(r,t,n);void 0!==o?c.step=o:(c.failed=!0,console.warn(`Couldn't not find any index for ${t}=${n}`))}else c.failed=!0,console.warn(`Missing key or value to search for (keyValue:'${e})`)}else s(i)?c.step=i:c.failed=!0;else c.failed=!0,console.warn(`Propery couldn't be found (step: '${i}' and type is: '${typeof i}')`);return c}function y(e,t,n){for(let r of Object.keys(e))if(c(e[r])&&e[r][t]==n)return r}function A(e,t){return!(!s(t)||!c(e)&&!Array.isArray(e))&&t in e}function R(e,t){return s(t)&&(c(e)||Array.isArray(e))?e[t]:e&&void 0===t?e:void 0}function P(e,t,n){return s(t)&&(c(e)||Array.isArray(e))?(e[t]=n,e[t]):e&&null==t?(c(n)?Object.assign(e,n):e=n,e):void console.log("Couldn't not set "+t)}function h(e){return e={hasProp:A,getProp:R,getSteps:a,...e||{}},function(t,n,r){return function t(n,o){if(o.length>0){const{step:i,_steps:s,failed:c}=d(o,n,r);return!c&&(e.hasProp(n,i)&&t(e.getProp(n,i),s))}return!0}(t,e.getSteps(n))}}function m(e){return e={getProp:R,hasProp:A,getSteps:a,...e||{}},function(t,n,r){return function t(n,o){if(o.length>0){const{step:i,_steps:s,failed:c}=d(o,n,r);return!c&&e.hasProp(n,i)?t(e.getProp(n,i),s):void 0}return n}(t,e.getSteps(n))}}function C(e){return e={setProp:P,getProp:R,hasProp:A,getSteps:a,...e||{}},function(t,n,r,o){const i=e.getSteps(n),s=(t,n,r)=>{if(n.length>0){const{step:i,_steps:p,failed:l}=d(n,t,o);if(l)return;if(p.length>0){const n=e.getProp(t,i),{step:l}=d(p,n,o);Number.isInteger(+l)&&!c(n)?e.hasProp(t,i)&&Array.isArray(n)?s(n,p,r):s(e.setProp(t,i,[]),p,r):e.hasProp(t,i)&&c(n)?s(e.getProp(t,i),p,r):s(e.setProp(t,i,{}),p,r)}else e.setProp(t,i,r)}else e.setProp(t,void 0,r)};s(t,i,r)}}const b=h(),v=m(),S=C();export{i as ARRAY_VALUE_SEPARATOR,o as CLOSED_BRACKET_PLACEHOLDER,n as DOT_PLACEHOLDER,e as OBJECT_KEY_PREFIX,r as OPEN_BRACKET_PLACEHOLDER,t as VARIABLE_PATH,u as escape,v as get,y as getIndexByChildKeyValue,R as getProp,b as has,A as hasProp,c as isObject,l as isStringifiedArray,s as isValidKey,m as makeGet,h as makeHas,C as makeSet,d as resolveStep,g as resolveVariable,S as set,P as setProp,a as splitPath,p as stringifyArray,f as unescape};
